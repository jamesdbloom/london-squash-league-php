<?php

require_once('../../load.php');
load::load_file('domain/user', 'userDAO.php');
load::load_file('domain/session', 'sessionDAO.php');

const login_url = '/admin/view/login/login.php';
const HASH_COOKIE_NAME = 'cookie_hash';
const REMEMBER_ME_COOKIE_NAME = 'remember_me';

function login_header($title = 'Log In', $message = '', $errors = '')
{
    ?><!DOCTYPE>
	<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
	<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title><?php PageSearchTerms::site_title; ?> &rsaquo; <?php echo $title; ?></title>
        <?php

        $login_header_url = "https://" . $_SERVER["SERVER_NAME"];

        ?>
        <style type="text/css">

            input:required:valid {
                /*background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAepJREFUeNrEk79PFEEUx9/uDDd7v/AAQQnEQokmJCRGwc7/QeM/YGVxsZJQYI/EhCChICYmUJigNBSGzobQaI5SaYRw6imne0d2D/bYmZ3dGd+YQKEHYiyc5GUyb3Y+77vfeWNpreFfhvXfAWAAJtbKi7dff1rWK9vPHx3mThP2Iaipk5EzTg8Qmru38H7izmkFHAF4WH1R52654PR0Oamzj2dKxYt/Bbg1OPZuY3d9aU82VGem/5LtnJscLxWzfzRxaWNqWJP0XUadIbSzu5DuvUJpzq7sfYBKsP1GJeLB+PWpt8cCXm4+2+zLXx4guKiLXWA2Nc5ChOuacMEPv20FkT+dIawyenVi5VcAbcigWzXLeNiDRCdwId0LFm5IUMBIBgrp8wOEsFlfeCGm23/zoBZWn9a4C314A1nCoM1OAVccuGyCkPs/P+pIdVIOkG9pIh6YlyqCrwhRKD3GygK9PUBImIQQxRi4b2O+JcCLg8+e8NZiLVEygwCrWpYF0jQJziYU/ho2TUuCPTn8hHcQNuZy1/94sAMOzQHDeqaij7Cd8Dt8CatGhX3iWxgtFW/m29pnUjR7TSQcRCIAVW1FSr6KAVYdi+5Pj8yunviYHq7f72po3Y9dbi7CxzDO1+duzCXH9cEPAQYAhJELY/AqBtwAAAAASUVORK5CYII=');*/
                /*background-image: url('data:image/png;base64,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');*/
                background-image: url('data:image/png;base64,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');
                background-position: right top;
                background-repeat: no-repeat;
                /*border-color: green;*/
            }

            input:required:invalid, input:focus:invalid {
                /*background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAeVJREFUeNqkU01oE1EQ/mazSTdRmqSxLVSJVKU9RYoHD8WfHr16kh5EFA8eSy6hXrwUPBSKZ6E9V1CU4tGf0DZWDEQrGkhprRDbCvlpavan3ezu+LLSUnADLZnHwHvzmJlvvpkhZkY7IqFNaTuAfPhhP/8Uo87SGSaDsP27hgYM/lUpy6lHdqsAtM+BPfvqKp3ufYKwcgmWCug6oKmrrG3PoaqngWjdd/922hOBs5C/jJA6x7AiUt8VYVUAVQXXShfIqCYRMZO8/N1N+B8H1sOUwivpSUSVCJ2MAjtVwBAIdv+AQkHQqbOgc+fBvorjyQENDcch16/BtkQdAlC4E6jrYHGgGU18Io3gmhzJuwub6/fQJYNi/YBpCifhbDaAPXFvCBVxXbvfbNGFeN8DkjogWAd8DljV3KRutcEAeHMN/HXZ4p9bhncJHCyhNx52R0Kv/XNuQvYBnM+CP7xddXL5KaJw0TMAF8qjnMvegeK/SLHubhpKDKIrJDlvXoMX3y9xcSMZyBQ+tpyk5hzsa2Ns7LGdfWdbL6fZvHn92d7dgROH/730YBLtiZmEdGPkFnhX4kxmjVe2xgPfCtrRd6GHRtEh9zsL8xVe+pwSzj+OtwvletZZ/wLeKD71L+ZeHHWZ/gowABkp7AwwnEjFAAAAAElFTkSuQmCC');*/
                /*background-image: url('data:image/png;base64,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');*/
                background-image: url('data:image/png;base64,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');
                background-position: right top;
                background-repeat: no-repeat;
                -moz-box-shadow: none;
                /*border-color: red;*/
            }

            .password-no-match {
                background-image: url('data:image/png;base64,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') !important;
                background-color: #db7093;
            }

        </style>
    </head>
	<body class="login">
	<div id="login">
		<h1>
            <p>
                <a href="<?php echo Urls::escape_and_sanitize_url($login_header_url); ?>" title="<?php echo PageSearchTerms::site_title; ?>"><?php echo PageSearchTerms::site_title; ?></a>
            </p>
        </h1>
    <h2><?php echo $title; ?></h2>
    <?php

    if (!empty($message))
        echo $message . "\n";

    global $errors;

    if (empty($errors)) {
        $errors = new Error();
    } else {
        Error::print_errors($errors);
    }
}

function login_footer($scripts = '')
{
    ?>
    <p id="nav">
        <a href="<?php echo login_url; ?>">Login</a> |
        <a href="<?php echo login_url . '?action=logout'; ; ?>">Logout</a> |
        <a href="<?php echo login_url . '?action=register'; ?>">Register</a> |
        <a href="<?php echo login_url . '?action=retrieve_password'; ?>" title="Password Lost and Found">Lost your password?</a>
    </p>

	</div>

    <div class="clear"></div>
    <?php echo $scripts; ?>
	</body>
	</html>
	<?php
}

function send_new_user_notification(User $user, $password, Error $errors)
{

    $title = PageSearchTerms::site_title . ' User Registration';
    $login_page_url = Urls::get_root_url() . login_url;
    $message = '
            <html>
            <head>
              <title>' . $title . '</title>
            </head>
            <body>
              <p>Someone requested registered account associated to this email address.</p>
              <p>If this was a mistake, just ignore this email and nothing will happen.</p>
              <p>To login to you account using the details below on the login page: <a href="' . $login_page_url . '">' . $login_page_url . '</a></p>
              <p>Username: ' . $user->email . '</p>
              <p>Password: ' . $password . '</p>
            </body>
            </html>
            ';

    Email::send_email($user->email, $title, $message, $errors);
}

function register_new_user($human_name, $email, $mobile, Error $errors)
{
    // Check the human_name
    if ($human_name == '') {
        $errors->add('empty_human_name', '<strong>ERROR</strong>: Please enter your name.');
    } elseif (!InputValidation::is_valid_human_name($human_name)) {
        $errors->add('invalid_human_name', '<strong>ERROR</strong>: The name is invalid because it uses characters that are not allowed.');
    }

    // Check the e-mail address
    if ($email == '') {
        $errors->add('empty_email', '<strong>ERROR</strong>: Please type your e-mail address.');
    } elseif (!InputValidation::is_valid_email_address($email)) {
        $errors->add('invalid_email', '<strong>ERROR</strong>: The email address isn&#8217;t correct.');
        $email = '';
    } elseif (UserDAO::email_already_registered($email, $errors)) {
        $errors->add('email_exists', '<strong>ERROR</strong>: This email is already registered, please choose another one.');
    }

    if (!$errors->has_errors()) {
        $password = Authentication::generate_password(12, true);
        $user = UserDAO::create($human_name, $password, $email, $mobile, Authentication::generate_password(20, true), $errors);
        if (empty($user)) {
            $errors->add('registerfail', sprintf('<strong>ERROR</strong>: Couldn&#8217;t register you... please contact <a href="mailto:%s">%s</a>', Urls::get_webmaster_email(), Urls::get_webmaster_email()));
        } else {
            send_new_user_notification($user, $password, $errors);
            return $user;
        }
    }
    return null;
}

function send_password_retrieval_email($email, Error $errors)
{
    if (empty($email)) {
        $errors->add('empty_email', '<strong>ERROR</strong>: Enter an e-mail address.');
    } else if (InputValidation::is_valid_email_address($email)) {
        $user = UserDAO::get_by_email($email, $errors);
        if (empty($user)) {
            $errors->add('invalid_email', '<strong>ERROR</strong>: There is no user registered with that email address.');
        }
    } else {
        $errors->add('invalid_email', '<strong>ERROR</strong>: Please enter a valid e-mail address.');
    }

    if (!$errors->has_errors() && !empty($user)) {
        // ensures email in correct case
        $database_email = $user->email;

        $allow = Authentication::allow_password_reset($database_email, $errors);

        if ($allow && !$errors->has_errors()) {
            $key = UserDAO::get_activation_key($database_email, $errors);
            if (empty($key)) {
                // Generate something random for a key...
                $key = Authentication::generate_password(20);
                // Now insert the new md5 key into the db
                UserDAO::update_activation_key($database_email, $key, $errors);
            }

            $title = PageSearchTerms::site_title . ' Password Reset';
            $reset_url = Urls::get_root_url() . login_url . "?action=reset_password&key=" . rawurlencode($key) . "&email=" . rawurlencode($database_email);
            $message = '
            <html>
            <head>
              <title>' . $title . '</title>
            </head>
            <body>
              <p>Someone requested that the password be reset for the account associated to this email address.</p>
              <p>If this was a mistake, just ignore this email and nothing will happen.</p>
              <p>To reset your password, visit the following address <a href="' . $reset_url . '">' . $reset_url . '</a></p>
            </body>
            </html>
            ';

            return Email::send_email($database_email, $title, $message, $errors);
        }
    }
    return false;
}

function reset_password($email, $new_password, Error $errors)
{
    UserDAO::update_password($email, $new_password, $errors);

    $message = 'Password Lost and Changed for user: ' . $email . '\r\n';
    Email::send_email(Urls::get_webmaster_email(), PageSearchTerms::site_title . ' Password Lost/Changed', $message, $errors);
}

function determine_action()
{
    $action = Parameters::read_request_input('action', 'login');

    $key = Parameters::read_get_input('key');
    if (!empty($key)) {
        $action = 'reset_password';
    }

    if (!in_array($action, array('postpass', 'logout', 'retrieve_password', 'reset_password', 'register', 'login'), true)) {
        $action = 'login';
    }

    return $action;
}

function remove_all_cookies()
{
    Cookies::remove_cookie(HASH_COOKIE_NAME);
    Cookies::remove_cookie(SSO_ID_COOKIE_NAME);
}

//
// START Main Page Control
//

$errors = new Error();

$action = determine_action();

Headers::set_nocache_headers();
Headers::set_content_type_header();
Cookies::set_test_cookie();

$is_http_post = ('POST' == $_SERVER['REQUEST_METHOD']);

switch ($action) {

    case 'postpass' :
        if (empty($password_hasher)) {
            load::load_file('/view/login', 'password_hash.php');
            $password_hasher = new PasswordHash(8, true);
        }

        // 10 days
        Cookies::set_cookie(HASH_COOKIE_NAME, $password_hasher->HashPassword(Parameters::read_post_input('post_password')), time() + 864000);

        Headers::redirect_to_referer();

        break;

    case 'logout' :
        Session::logout($errors);
        remove_all_cookies();

        Headers::redirect_to_root();

        break;

    case 'retrieve_password' :
        $redirect_to = Parameters::read_request_input('redirect_to', login_url);

        if ($is_http_post) {
            $email = Parameters::read_post_input('email');
            send_password_retrieval_email($email, $errors);

            if (!$errors->has_errors()) {
                Headers::set_redirect_header(login_url . "?check_email=retrieve_password");
                break;
            }
        }

        $error = Parameters::read_post_input('error');
        if ($error == 'invalidkey') {
            $errors->add('invalidkey', 'Sorry, that key does not appear to be valid.');
        }

        login_header('Lost Password', '<p class="message">' . 'Please enter your email address. You will receive a link to create a new password via email.' . '</p>', $errors);

        $email = Parameters::read_post_input('email');

        ?>

        <form name="retrieve_password_form" id="retrieve_password_form" action="<?php login_url ?>?action=retrieve_password" method="post">
            <p>
                <label for="email">E-mail:<br/>
                    <input type="email" name="email" id="email" class="input" value="<?php echo Urls::escape_and_sanitize_attribute_value($email); ?>" size="35" required="required"
                           pattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?" tabindex="10"/>
                </label>
            </p>
            <input type="hidden" name="redirect_to" value="<?php echo Urls::escape_and_sanitize_attribute_value($redirect_to); ?>"/>

            <p class="submit">
                <input type="submit" name="submit" class="button-primary" value="Get New Password" tabindex="100"/>
            </p>
        </form>

        <?php
        login_footer();
        break;

    case 'reset_password' :
        $key = rawurldecode(Parameters::read_get_input('key'));
        $email = rawurldecode(Parameters::read_get_input('email'));

        $user = Authentication::check_password_activation_key($key, $email, $errors);

        if (empty($user)) {
            Headers::set_redirect_header(login_url . '?action=retrieve_password&error=invalidkey');
        }

        if ($is_http_post) {
            UserDAO::update_activation_key($email, '', $errors);
            $password_one = Parameters::read_post_input('password_one');
            $password_two = Parameters::read_post_input('password_two');
            if (!empty($password_one) && $password_one != $password_two) {
                $errors->add('password_reset_mismatch', 'The passwords do not match.');
            } elseif (!empty($password_one)) {
                reset_password($email, $password_one, $errors);
                login_header('Password Reset', '<p class="message reset-pass">' . 'Your password has been reset ' . ' <a href="' . login_url . '">' . 'Log in' . '</a></p>', $errors);
                login_footer();
                break;
            }
        }

        login_header('Reset Password', '<p class="message reset-pass">' . 'Enter your new password below.' . '</p>', $errors);

        ?>
        <form name="reset_password_form" id="reset_password_form" action="<?php echo login_url . '?action=reset_password&key=' . rawurlencode($key) . '&email=' . rawurlencode($email); ?>" method="post">
            <input type="hidden" name="email" value="<?php echo Urls::escape_and_sanitize_attribute_value(Parameters::read_post_input('email')); ?>" autocomplete="off"/>

            <p>
                <label for="password_one">New password<br/>
                    <input type="password" name="password_one" id="password_one" class="input" size="35" required="required" pattern="^.{2,10}\b(\|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\-|\_|\[|\]|\{|\}|\<|\>|\~|\`|\+|\=|\,|\.|\;|\:|\/|\?|\|)\b.{2,10}$" value="" autocomplete="off"
                           tabindex="10"/>
                </label>
            </p>

            <p>
                <label for="password_two">Confirm new password<br/>
                    <input type="password" name="password_two" id="password_two" class="input" size="35" required="required" pattern="^.{2,10}\b(\|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\-|\_|\[|\]|\{|\}|\<|\>|\~|\`|\+|\=|\,|\.|\;|\:|\/|\?|\|)\b.{2,10}$" value="" autocomplete="off"
                           tabindex="20"
                           onkeyup="if(this.value == document.getElementById('password_one').value) { this.setAttribute('class', 'input'); } else { this.setAttribute('class', 'password-no-match input'); }"/>
                </label>
            </p>

            <p class="description indicator-hint">Hint: The password should be at least seven characters long. To make it stronger, use upper and lower case letters, numbers and symbols like ! " ? $ % ^ &amp;</p>

            <br class="clear"/>

            <p class="submit">
                <input type="submit" name="submit" class="button-primary" value="Reset Password" tabindex="100"/>
            </p>
        </form>

        <?php
        login_footer();
        break;

    case 'register' :
        $human_name = '';
        $email = '';
        $mobile = '';
        $redirect_to = Parameters::read_post_input('redirect_to', login_url);

        if ($is_http_post) {
            $human_name = Parameters::read_post_input('human_name');
            $email = Parameters::read_post_input('email');
            $mobile = Parameters::read_post_input('mobile');
            register_new_user($human_name, $email, $mobile, $errors);
            $redirect_to = login_url . "?check_email=registered";

            if (!$errors->has_errors()) {
                Headers::set_redirect_header($redirect_to);
                break;
            }
        }

        login_header('New User Registration', '<p class="message register">' . 'Please enter your details and a temporary password will be e-mailed to you.' . '</p>', $errors);
        ?>

        <form name="registerform" id="registerform" action="<?php echo login_url . '?action=register'; ?>" method="post">
            <p>
                <label for="human_name">Name<br/>
                    <input type="text" name="human_name" id="human_name" class="input" value="<?php echo Urls::escape_and_sanitize_attribute_value($human_name); ?>" size="35" required="required" pattern=".{3,25}" tabindex="10"/>
                </label>
            </p>

            <p>
                <label for="email">E-mail<br/>
                    <input type="email" name="email" id="email" class="input" value="<?php echo Urls::escape_and_sanitize_attribute_value($email); ?>" size="35" required="required"
                           pattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?" tabindex="20"/>
                </label>
            </p>

            <p>
                <label for="mobile">Mobile (optional - if provided shown to league members in your division)<br/>
                    <input type="tel" name="mobile" id="mobile" class="input" value="<?php echo Urls::escape_and_sanitize_attribute_value($mobile); ?>" size="35" pattern="\d{5,25}" tabindex="30"/>
                </label>
            </p>

            <input type="hidden" name="redirect_to" value="<?php echo Urls::escape_and_sanitize_attribute_value($redirect_to); ?>"/>

            <p class="submit">
                <input type="submit" name="submit" class="button-primary" value="Register" tabindex="100"/>
            </p>
        </form>

        <?php
        login_footer();
        break;

    case 'login' :
    default:
        // todo handle redirecting back to referer page
        $redirect_to = Parameters::read_request_input('redirect_to', Urls::get_root_url());

        $email = Parameters::read_post_input('email');
        $password = Parameters::read_post_input('password');

        $check_email = Parameters::read_get_input('check_email');
        if (!empty($check_email)) {
            if ($check_email == 'registered') {
                $errors->add('registered', 'Registration complete - please check your e-mail for your temporary password.', 'message');
            } elseif ($check_email == 'retrieve_password') {
                $errors->add('new_password', 'Please check your e-mail to reset your password', 'message');
            }
        } else {
            $session = Session::create_session($email, $password, $errors);
        }

        $remember_me = strlen(Parameters::read_post_input('remember_me')) > 0;

        if ($is_http_post) {
            // If cookies are disabled we can't log in even with a valid user+pass
            $test_cookie = Cookies::get_test_cookie();

            if (empty($test_cookie)) {
                $errors->add('test_cookie', "<strong>ERROR</strong>: Cookies are blocked or not supported by your browser. You must <a href='http://www.google.com/cookies.html'>enable cookies</a> to use this site.");
            }

            if (!$remember_me) {
                Cookies::remove_cookie(REMEMBER_ME_COOKIE_NAME);
            }
        }

        if (!$errors->has_errors() && !empty($session)) {
            if ($remember_me) {
                Cookies::set_cookie(REMEMBER_ME_COOKIE_NAME, $email);
            }
            Headers::set_redirect_header($redirect_to);
            break;
        }

        if (empty($email)) {
            $email = Cookies::get_cookie_value(REMEMBER_ME_COOKIE_NAME);
        }

        login_header('Log In', '', $errors);
        ?>

        <form name="loginform" id="loginform" action="<?php echo login_url; ?>" method="post">

            <input type="hidden" name="redirect_to" value="<?php echo Urls::escape_and_sanitize_attribute_value($redirect_to); ?>"/>

            <p>
                <label for="email">E-mail<br/>
                    <input type="email" name="email" id="email" class="input" value="<?php echo Urls::escape_and_sanitize_attribute_value($email); ?>" size="35" required="required"
                           pattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?" tabindex="10"/>
                </label>
            </p>

            <p>
                <label for="password">Password<br/>
                    <input type="password" name="password" id="password" class="input" value="" size="35" required="required" tabindex="20"/>
                </label>
            </p>

            <p>
                <label for="remember_me">
                    <input name="remember_me" type="checkbox" id="remember_me" value="forever" tabindex="90"<?php echo Form::checked(strlen(Cookies::get_cookie_value(REMEMBER_ME_COOKIE_NAME)) > 0); ?> />Remember Me
                </label>
            </p>

            <p class="submit">
                <input type="submit" name="submit" id="login-submit" class="button-primary" value="Log In" tabindex="100"/>
            </p>
        </form>

        <?php
        login_footer();
        break;
}
//
// END Main Page Control
//

?>